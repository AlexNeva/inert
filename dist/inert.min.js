"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();!function(e){function t(t){if(!t.querySelector("style#inert-style")){var r=e.createElement("style");r.setAttribute("id","inert-style"),r.textContent="\n[inert], [inert] * {\n  pointer-events: none;\n  cursor: default;\n  user-select: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n}\n",t.appendChild(r)}}var r="attachShadow"in Element.prototype,n=["article","aside","blockquote","body","div","footer","h1","h2","h3","h4","h5","h6","header","main","nav","p","section","span"].join(","),o=function(){function t(o,i){if(_classCallCheck(this,t),this._rootElement=o,this._rootTabindex=o.getAttribute("tabindex")||null,o.setAttribute("aria-hidden","true"),o.tabIndex=-1,o.blur(),o.firstElementChild){var a=e.activeElement;for(a===e.body&&(a=null);a;){if(o.contains(a)){a.blur();break}a=a.shadowRoot?a.shadowRoot.activeElement:null}}if(r&&o.matches(n)||o.localName.indexOf("-")!==-1){if(o.shadowRoot)for(var s=o.shadowRoot.querySelectorAll("[inert]"),l=0,u=s.length;l<u;l++)i.setInert(s[l],!0);else{o.attachShadow({mode:"open"}).appendChild(e.createElement("slot"));var h=o.attachShadow;o.attachShadow=function(){var e=this.shadowRoot.querySelector("slot");return e&&this.shadowRoot.removeChild(e),this.attachShadow=h,this.shadowRoot}}this._observer=new MutationObserver(i.watchForInert),this._observer.observe(o.shadowRoot,{attributes:!0,subtree:!0,childList:!0})}}return _createClass(t,[{key:"destructor",value:function(){this._observer&&this._observer.disconnect(),this._rootElement.removeAttribute("aria-hidden"),this._rootTabindex?this._rootElement.setAttribute("tabindex",this._rootTabindex):this._rootElement.removeAttribute("tabindex"),this._observer=null,this._rootElement=null,this._rootTabindex=null}}]),t}(),i=function(){function e(r){var n=this;if(_classCallCheck(this,e),!r)throw new Error("Missing required argument; InertManager needs to wrap a document.");if(this._document=r,this._inertRoots=new Map,this.watchForInert=this._watchForInert.bind(this),this._observer=new MutationObserver(this.watchForInert),t(r.head||r.body||r.documentElement),"loading"===r.readyState){var o=function e(){r.removeEventListener("readystatechange",e),n._onDocumentLoaded()};r.addEventListener("readystatechange",o)}else this._onDocumentLoaded()}return _createClass(e,[{key:"setInert",value:function(e,r){if(this._inertRoots.has(e)!==r)if(r){var n=new o(e,this);if(e.setAttribute("inert",""),this._inertRoots.set(e,n),!this._document.body.contains(e))for(var i=e.parentNode;i;){if(i.nodeType===Node.DOCUMENT_FRAGMENT_NODE){t(i);break}i=i.parentNode}}else{var a=this._inertRoots.get(e);a.destructor(),this._inertRoots.delete(e),e.removeAttribute("inert")}}},{key:"getInertRoot",value:function(e){return this._inertRoots.get(e)}},{key:"_onDocumentLoaded",value:function(){var e=Array.from(this._document.querySelectorAll("[inert]")),t=!0,r=!1,n=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;this.setInert(a,!0)}}catch(e){r=!0,n=e}finally{try{!t&&i.return&&i.return()}finally{if(r)throw n}}this._observer.observe(this._document.body,{attributes:!0,subtree:!0,childList:!0})}},{key:"_watchForInert",value:function(e,t){var r=!0,n=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(r=(i=a.next()).done);r=!0){var s=i.value;switch(s.type){case"childList":var l=!0,u=!1,h=void 0;try{for(var c,d=Array.from(s.addedNodes)[Symbol.iterator]();!(l=(c=d.next()).done);l=!0){var f=c.value;if(f.nodeType===Node.ELEMENT_NODE){var v=Array.from(f.querySelectorAll("[inert]"));f.matches("[inert]")&&v.unshift(f);var b=!0,y=!1,m=void 0;try{for(var _,w=v[Symbol.iterator]();!(b=(_=w.next()).done);b=!0){var p=_.value;this.setInert(p,!0)}}catch(e){y=!0,m=e}finally{try{!b&&w.return&&w.return()}finally{if(y)throw m}}}}}catch(e){u=!0,h=e}finally{try{!l&&d.return&&d.return()}finally{if(u)throw h}}break;case"attributes":if("inert"!==s.attributeName)continue;var E=s.target,g=E.hasAttribute("inert");this.setInert(E,g)}}}catch(e){n=!0,o=e}finally{try{!r&&a.return&&a.return()}finally{if(n)throw o}}}}]),e}(),a=new i(e);Object.defineProperty(Element.prototype,"inert",{enumerable:!0,get:function(){return this.hasAttribute("inert")},set:function(e){a.setInert(this,e)}});var s=Object.getOwnPropertyDescriptor(HTMLElement.prototype,"focus");Object.defineProperty(HTMLElement.prototype,"focus",{enumerable:!0,configurable:!0,writable:!0,value:function(){for(var e=this;e&&!e.inert;){for(;e.assignedSlot;)e=e.assignedSlot;e=e.parentNode||e.host}if(!e||!e.inert)return s.value.call(this)}})}(document);